<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                template="/templates/main.xhtml">

    <ui:define name="scripts">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <!-- bootbox.js at 4.4.0 -->
        <script
                src="https://rawgit.com/makeusabrew/bootbox/f3a04a57877cab071738de558581fbc91812dce9/bootbox.js"></script>
        <script>
        $(document).ready(function(){
        var ctx = "${pageContext.request.contextPath}";
        $( ".delete-vehicle-button" ).button().on( "click", function() {
                    var $this = $(this).closest('tr').children();
                    var vehicleBrand = $this.eq(1).text();
                    var vehicleModel = $this.eq(2).text();
                    var vehicleVIN = $this.eq(4).text();
                    vehicleId = $this.eq(0).text();
                    console.log("deleting");
                    bootbox.confirm("Usunąć pojazd "+vehicleBrand+" "+vehicleModel+"("+vehicleVIN+")?" , function(result){
                      if(result == true)
                        deleteVehicle(vehicleId, ctx);
                    });

                });
        });
        </script>

    </ui:define>

<ui:define name="content">

<a href="#{request.contextPath}/vehicles/add" class="btn btn-success">Dodaj pojazd</a>

<h:dataTable class="table table-hover" id="vehicles_table" value="#{vehicleManager.all}" var="vehicle">
    <thead>
        <tr>
            <td>ID</td>
            <td>Marka</td>
            <td>Typ</td>
            <td>Silnik</td>
            <td>VIN</td>
            <td>KM</td>
            <td>Przebieg</td>
            <td>Edycja</td>
            <td>Usuwanie</td>
        </tr>
    </thead>
    <h:column>
        <f:facet name="header">Id</f:facet>
        #{vehicle.id}
    </h:column>
    <h:column>
        <f:facet name="header">Marka</f:facet>
        #{vehicle.brand}
    </h:column>
    <h:column>
        <f:facet name="header">Model</f:facet>
        #{vehicle.model}
    </h:column>
    <h:column>
        <f:facet name="header">Silnik</f:facet>
        #{vehicle.engine}
    </h:column>
    <h:column>
        <f:facet name="header">VIN</f:facet>
        #{vehicle.VIN}
    </h:column>
    <h:column>
        <f:facet name="header">Przebieg</f:facet>
        #{vehicle.mileage}
    </h:column>
    <h:column>
        <f:facet name="header">KM</f:facet>
        #{vehicle.horsepower}
    </h:column>
    <h:column>
        <f:facet name="header">Edycja</f:facet>
        <a class="btn btn-primary edit-vehicle-button" href="vehicles/edit/#{vehicle.id}">Edytuj</a>
    </h:column>
    <h:column>
        <f:facet name="header">Usuwanie</f:facet>
        <a class="btn btn-danger delete-vehicle-button" id="delete-button-#{vehicle.id}">Usuń</a>
    </h:column>
</h:dataTable>

</ui:define>
</ui:composition>